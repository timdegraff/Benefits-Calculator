<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MI Benefit Calculator 2026</title>
    <style>
        :root {
            --primary: #007AFF; /* iOS Blue */
            --bg: #F2F2F7;
            --card: #FFFFFF;
            --text: #000000;
            --subtext: #8E8E93;
            --platinum: #5E5CE6; /* Indigo */
            --silver: #A0A0A5;
            --gold: #FF9500;
            --cliff: #FF3B30;
            --thumb-color: #007AFF; 
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 20px;
            -webkit-tap-highlight-color: transparent;
        }
        .container { max-width: 600px; margin: 0 auto; padding-bottom: 40px; }
        h1 { font-size: 24px; text-align: center; margin-bottom: 20px; }
        
        /* Tabs */
        .tabs {
            display: flex; background: #E5E5EA; border-radius: 12px; padding: 2px; margin-bottom: 20px;
        }
        .tab {
            flex: 1; text-align: center; padding: 10px; font-weight: 600; font-size: 14px;
            border-radius: 10px; cursor: pointer; transition: background 0.2s;
        }
        .tab.active { background: var(--card); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }

        /* Cards */
        .card {
            background: var(--card); border-radius: 16px; padding: 20px;
            margin-bottom: 15px; box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .hidden { display: none; }

        /* Controls */
        label { display: block; font-size: 14px; color: var(--subtext); margin-bottom: 4px; font-weight: 600; }
        .helper-text { display: block; font-size: 11px; color: #666; margin-bottom: 12px; line-height: 1.3; }
        
        .value-display { color: var(--text); font-weight: 600; float: right; }
        .limit-display { display: block; font-size: 11px; color: var(--cliff); margin-top: -5px; margin-bottom: 10px; text-align: right; }
        .deduct-limit-display { font-size: 12px; color: var(--subtext); font-weight: 400; margin-left: 5px; }
        
        /* Auto-Max Row */
        .lock-row {
            display: flex; justify-content: flex-end; align-items: center;
            margin-top: -5px; margin-bottom: 10px;
        }
        .lock-label { font-size: 12px; color: var(--primary); margin-right: 6px; font-weight: 600; }
        input.lock-check { width: 16px; height: 16px; margin: 0; accent-color: var(--primary); }

        /* Slider Group with Buttons */
        .slider-group { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; margin-top: 10px; }
        input[type="range"] { flex: 1; accent-color: var(--primary); height: 25px; }
        
        /* Custom Slider Styling for Gradient Track */
        input[type=range].gradient-slider {
            -webkit-appearance: none;
            width: 100%;
            background: transparent; 
            border-radius: 12px;
            height: 12px; 
        }
        
        input[type=range].gradient-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 28px; width: 28px; border-radius: 50%;
            background: var(--thumb-color); 
            cursor: pointer; margin-top: 0px; 
            box-shadow: 0 2px 6px rgba(0,0,0,0.3); border: 2px solid white;
            transition: background-color 0.2s ease;
        }
        
        input[type=range].gradient-slider::-moz-range-thumb {
            height: 28px; width: 28px; border-radius: 50%;
            background: var(--thumb-color);
            cursor: pointer; border: 2px solid white;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
            transition: background-color 0.2s ease;
        }

        .tune-btn {
            width: 32px; height: 32px; border-radius: 50%; border: 1px solid #E5E5EA;
            background: #F9F9F9; color: var(--primary); font-size: 18px; line-height: 1;
            display: flex; align-items: center; justify-content: center; cursor: pointer;
            user-select: none;
        }
        .tune-btn:active { background: #E5E5EA; }

        /* Checkbox */
        .checkbox-row { display: flex; align-items: center; margin-top: 15px; margin-bottom: 5px; }
        input[type="checkbox"] { width: 20px; height: 20px; margin-right: 10px; accent-color: var(--primary); }
        .cb-label { font-size: 15px; color: var(--text); font-weight: 500; }

        /* Results & Math */
        .result-box {
            text-align: center; padding: 15px; border-radius: 12px; background: #F2F2F7; margin-top: 10px;
        }
        .result-title { font-size: 18px; font-weight: 700; margin-bottom: 5px; color: var(--primary); }
        .result-desc { font-size: 13px; color: var(--subtext); line-height: 1.4; }
        
        details { margin-top: 15px; text-align: left; font-size: 13px; color: var(--subtext); }
        summary { cursor: pointer; color: var(--primary); font-weight: 500; margin-bottom: 5px; outline: none; }
        .math-row { display: flex; justify-content: space-between; margin-bottom: 4px; border-bottom: 1px dashed #E5E5EA; padding-bottom: 2px; }
        .math-val { font-family: monospace; color: var(--text); }

        .legal { font-size: 10px; color: #999; text-align: center; margin-top: 30px; line-height: 1.4; }
    </style>
</head>
<body>

<div class="container">
    <h1>MI Benefits 2026</h1>

    <div class="tabs">
        <div class="tab active" onclick="switchTab('health')">Health Coverage</div>
        <div class="tab" onclick="switchTab('snap')">SNAP (Food)</div>
    </div>

    <div class="card">
        <label>Household Size: <span id="hhSizeVal" class="value-display">8</span></label>
        <div class="slider-group">
            <div class="tune-btn" onclick="adjustVal('hhSize', -1)">-</div>
            <input type="range" id="hhSize" min="1" max="10" value="8" oninput="updateCalculations()">
            <div class="tune-btn" onclick="adjustVal('hhSize', 1)">+</div>
        </div>
    </div>

    <div id="healthTab">
        <div class="card">
            <label>Annual Income: <span id="incomeVal" class="value-display">$40,000</span></label>
            <div class="slider-group" style="margin-bottom: 8px;">
                <div class="tune-btn" onclick="adjustVal('annualIncome', -1000)">-</div>
                <input type="range" id="annualIncome" class="gradient-slider" min="0" max="300000" step="1000" value="40000" oninput="updateCalculations()">
                <div class="tune-btn" onclick="adjustVal('annualIncome', 1000)">+</div>
            </div>
            
            <div class="checkbox-row">
                <input type="checkbox" id="pregCheck" onchange="updateCalculations()">
                <span class="cb-label">Household member is pregnant?</span>
            </div>

            <div id="healthResult" class="result-box hidden">
                <div id="healthTitle" class="result-title">--</div>
                <div id="healthDesc" class="result-desc">--</div>
            </div>
        </div>
    </div>

    <div id="snapTab" class="hidden">
        <div class="card">
            <label>Annual Gross Income <span id="snapIncomeVal" class="value-display">$40,000</span></label>
            <div class="slider-group" style="margin-bottom: 5px;">
                <div class="tune-btn" onclick="adjustVal('annualSnapIncome', -1000)">-</div>
                <input type="range" id="annualSnapIncome" min="0" max="100000" step="1000" value="40000" oninput="updateCalculations()">
                <div class="tune-btn" onclick="adjustVal('annualSnapIncome', 1000)">+</div>
            </div>
            <span id="snapLimitText" class="limit-display">Max Allowed: --</span>
            
            <label>Monthly Shelter & Utility Costs <span id="deductLimitText" class="deduct-limit-display">(Limit: $2000)</span> <span id="deductVal" class="value-display">$2,000</span></label>
            <span class="helper-text">Sum of: Rent/Mortgage, Property Tax, Insurance, Heating, Cooling, Electric, Water, Phone.</span>
            
            <div class="lock-row">
                <span class="lock-label">Auto-Set Max</span>
                <input type="checkbox" class="lock-check" id="autoMaxDeductions" onchange="updateCalculations()">
            </div>

            <div class="slider-group">
                <div class="tune-btn" onclick="adjustVal('monthlyDeductions', -100)">-</div>
                <input type="range" id="monthlyDeductions" min="0" max="5000" step="100" value="2000" oninput="updateCalculations()">
                <div class="tune-btn" onclick="adjustVal('monthlyDeductions', 100)">+</div>
            </div>

            <div class="checkbox-row">
                <input type="checkbox" id="disabilityCheck" onchange="updateCalculations()">
                <span class="cb-label">Household member is disabled or 60+?</span>
            </div>

            <div id="snapResult" class="result-box hidden">
                <div id="snapTitle" class="result-title">--</div>
                <div id="snapDesc" class="result-desc">--</div>
                
                <details>
                    <summary>Show Calculation</summary>
                    <div id="mathContent"></div>
                </details>
            </div>
        </div>
    </div>

    <div class="legal">
        Disclaimer: Estimates only. Not official determination. "Platinum" refers to plan value equivalence.
    </div>
</div>

<script>
    function getFPL(size) { return 15650 + ((size - 1) * 5500); }
    function getMaxSnap(size) { return 292 + ((size - 1) * 215); } 
    function getStdDeduction(size) {
        if (size <= 3) return 198;
        if (size == 4) return 208;
        if (size == 5) return 244;
        return 279;
    }

    function adjustVal(id, amount) {
        const el = document.getElementById(id);
        if (el.disabled) return; 
        let newVal = parseFloat(el.value) + amount;
        if (newVal < parseFloat(el.min)) newVal = parseFloat(el.min);
        if (newVal > parseFloat(el.max)) newVal = parseFloat(el.max);
        el.value = newVal;
        updateCalculations();
    }

    function switchTab(tab) {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelector(`.tab[onclick="switchTab('${tab}')"]`).classList.add('active');
        document.getElementById('healthTab').classList.add('hidden');
        document.getElementById('snapTab').classList.add('hidden');
        document.getElementById(`${tab}Tab`).classList.remove('hidden');
    }

    function updateCalculations() {
        const size = parseInt(document.getElementById('hhSize').value);
        document.getElementById('hhSizeVal').innerText = size;

        // Health Logic
        const annualInc = parseFloat(document.getElementById('annualIncome').value);
        document.getElementById('incomeVal').innerText = "$" + annualInc.toLocaleString();
        
        updateTrackGradient(size); 
        calcHealth(size, annualInc);

        // SNAP Logic
        const fpl100_annual = getFPL(size);
        const limit_annual = fpl100_annual * 2.0; 
        
        const snapIncomeSlider = document.getElementById('annualSnapIncome');
        const snapDeductSlider = document.getElementById('monthlyDeductions');
        const isAutoMax = document.getElementById('autoMaxDeductions').checked;

        // Cap Income Slider
        snapIncomeSlider.max = limit_annual;
        document.getElementById('snapLimitText').innerText = "Max Allowed: $" + limit_annual.toLocaleString() + "/yr";

        let snapAnnual = parseFloat(snapIncomeSlider.value);
        if (snapAnnual > limit_annual) snapAnnual = limit_annual;

        const currentMonthlyIncome = snapAnnual / 12;

        // Calculate the Max Possible Deduction (Round up to nearest 100)
        let maxDeduction = Math.ceil(currentMonthlyIncome / 100) * 100;
        if (maxDeduction === 0) maxDeduction = 0;

        // Update Visual Limit Text
        document.getElementById('deductLimitText').innerText = "(Limit: $" + maxDeduction + ")";

        // Auto-Max Logic
        if (isAutoMax) {
            snapDeductSlider.max = 5000; 
            snapDeductSlider.value = maxDeduction;
            snapDeductSlider.disabled = true; 
        } else {
            snapDeductSlider.disabled = false;
            snapDeductSlider.max = maxDeduction; 
            if (parseFloat(snapDeductSlider.value) > maxDeduction) {
                snapDeductSlider.value = maxDeduction;
            }
        }

        let snapDeduct = parseFloat(snapDeductSlider.value);
        document.getElementById('snapIncomeVal').innerText = "$" + snapAnnual.toLocaleString();
        document.getElementById('deductVal').innerText = "$" + snapDeduct.toLocaleString();

        calcSnap(size, currentMonthlyIncome, snapDeduct);
    }

    function updateTrackGradient(size) {
        const fpl = getFPL(size);
        const maxSlider = 300000;
        const isPreg = document.getElementById('pregCheck').checked;
        const platLimit = isPreg ? 1.95 : 1.38;

        const pPlat = ((fpl * platLimit) / maxSlider) * 100;
        const pSilver = ((fpl * 2.50) / maxSlider) * 100; 
        const pGold = ((fpl * 4.00) / maxSlider) * 100;

        const slider = document.getElementById('annualIncome');
        const currentVal = parseFloat(slider.value);
        const currentPercent = (currentVal / maxSlider) * 100;

        slider.style.background = `linear-gradient(to right, 
            var(--platinum) 0%, var(--platinum) ${pPlat}%, 
            var(--silver) ${pPlat}%, var(--silver) ${pSilver}%, 
            var(--gold) ${pSilver}%, var(--gold) ${pGold}%, 
            var(--cliff) ${pGold}%, var(--cliff) 100%)`;

        let bubbleColor = "var(--platinum)";
        if (currentPercent > pGold) bubbleColor = "var(--cliff)";
        else if (currentPercent > pSilver) bubbleColor = "var(--gold)";
        else if (currentPercent > pPlat) bubbleColor = "var(--silver)";
        
        document.documentElement.style.setProperty('--thumb-color', bubbleColor);
    }

    function calcHealth(size, income) {
        const resultBox = document.getElementById('healthResult');
        const title = document.getElementById('healthTitle');
        const desc = document.getElementById('healthDesc');
        const isPreg = document.getElementById('pregCheck').checked;

        resultBox.classList.remove('hidden');
        const fpl100 = getFPL(size);
        const fplPercent = (income / fpl100) * 100;
        resultBox.className = 'result-box';
        
        const platThreshold = isPreg ? 195 : 138;

        if (fplPercent <= platThreshold) {
            title.innerText = isPreg ? "Healthy Michigan (Pregnancy)" : "Healthy Michigan Plan (Platinum)";
            desc.innerText = isPreg 
                ? "Extended coverage limit (195% FPL). $0 premiums." 
                : "State-sponsored. $0 premiums.";
            resultBox.style.border = "2px solid var(--platinum)";
            title.style.color = "var(--platinum)";
        } else if (fplPercent <= 250) {
            title.innerText = "Silver Plus (High Value)";
            desc.innerText = "Eligible for CSR (Lower deductibles).";
            resultBox.style.border = "2px solid var(--silver)";
            title.style.color = "#666";
        } else if (fplPercent <= 400) {
            title.innerText = "Standard Marketplace";
            desc.innerText = "Eligible for Premium Tax Credits.";
            resultBox.style.border = "2px solid var(--gold)";
            title.style.color = "var(--gold)";
        } else {
            title.innerText = "Subsidy Cliff";
            desc.innerText = "Full price premiums apply.";
            resultBox.style.border = "2px solid var(--cliff)";
            title.style.color = "var(--cliff)";
        }
    }

    function calcSnap(size, monthlyIncome, deductions) {
        const resultBox = document.getElementById('snapResult');
        const title = document.getElementById('snapTitle');
        const desc = document.getElementById('snapDesc');
        const mathDiv = document.getElementById('mathContent');
        const isDisabled = document.getElementById('disabilityCheck').checked;

        resultBox.classList.remove('hidden');
        const maxBenefit = getMaxSnap(size);
        const stdDed = getStdDeduction(size);
        
        const adjIncome = Math.max(0, monthlyIncome - stdDed);
        const halfAdjIncome = adjIncome * 0.5;
        let excessShelter = Math.max(0, deductions - halfAdjIncome);
        
        const shelterCap = 700; 
        if (!isDisabled && excessShelter > shelterCap) {
            excessShelter = shelterCap;
        }

        const netIncome = Math.max(0, adjIncome - excessShelter);
        const benefitCalc = maxBenefit - (0.3 * netIncome);
        
        let finalBenefit = 0;
        if (benefitCalc > 0) {
            finalBenefit = Math.max(0, Math.round(benefitCalc));
            if (size <= 2 && finalBenefit < 23 && finalBenefit > 0) finalBenefit = 23;
        }

        if (finalBenefit > 0) {
            title.innerText = `$${finalBenefit} / month`;
            desc.innerText = "Estimated SNAP Benefit.";
            title.style.color = "var(--primary)";
        } else {
            title.innerText = "$0 Benefit";
            desc.innerText = "Benefit reduces to zero.";
            title.style.color = "var(--subtext)";
        }

        mathDiv.innerHTML = `
            <div class="math-row"><span>Max Grant:</span> <span class="math-val">$${maxBenefit}</span></div>
            <div class="math-row"><span>Gross Income:</span> <span class="math-val">$${Math.round(monthlyIncome)}</span></div>
            <div class="math-row"><span>- Std Ded:</span> <span class="math-val">$${stdDed}</span></div>
            <div class="math-row"><span>- Shelter Ded:</span> <span class="math-val">$${Math.round(excessShelter)}</span></div>
            <div class="math-row"><span>= Net Income:</span> <span class="math-val">$${Math.round(netIncome)}</span></div>
            <div class="math-row" style="margin-top:5px; color:var(--primary)"><span>Result:</span> <span class="math-val">$${maxBenefit} - 30% Net</span></div>
        `;
    }

    window.onload = updateCalculations;
</script>

</body>
</html>
